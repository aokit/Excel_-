■Range_組織辞書　から　組織辞書┏　へ：

これまで：
組織辞書はシート上では長さ（１行の列数）の異なる、かつ、長さの変わりうる
行数の変わりうる行の連続した範囲であったため、事前に範囲を定めることが
難しいと考え『概ね最大列数』を２０と想定して　Range_組織辞書　を設定して
いた。概ねこれでよさそうではあった。

これから：
組織辞書の読み取りを　組織辞書読み取り　から　SingleHomeDict_namedRange
に一般化した。SingleHomeDict_namedRange　は、 SingleHomeDict　による
単一の見出し　から　複数の類義　を表現する　１対多対応　のシート上の範囲
を　辞書　に読み込むプロシジャである。
単一の見出し　もしくは　複数の類義　のいずれかがマッチすると、マッチする
行の行番号を返す　辞書　が得られる。
（単一の見出し　が得られるわけではないことに注意。）
（また、単一の見出し　と
　一致する文字列が、　複数の類義　の中に再登場することは許容されない。
　＜そのはず…そうなったらどういう動作をするのかは確認していないが、確認
　　しておいたほうがよいと思う＞　【要確認】）
（また、ある　単一の見出し　に属する　複数の類義　のうちの一つが、他の
　単一の見出し　に属する　複数の類義　に再登場することは許容されない。
　＜こちらも、そのはず…そうなったらどういう動作をするのかは確認していな
　　いが、確認しておいたほうがよいと思う＞　【要確認】
　なお、複数の類義　の要素について、同じ文字列の再登場　を許す　辞書　を
　得る別のプロシジャとして　MultiHomeDict　を別途作成してある。）

この　SingleHomeDict_namedRange　では、組織辞書の性質；
・１行の列数が不定
・行数が不定
＜ただし、行はかならず　第１の列　を有する。それにより行数を計数できる＞
＜また、最初の空行の前までが範囲となる＞
を、適切に処理できるようにした。つまり、範囲の左上角のセルを指定すればよ
いようにしたので、事前に想定列数や行数を設定する
・Range_組織辞書
の使用をやめ、組織辞書の左上角のセルに対する名前
・組織辞書┏
を使用することにした。
また、組織辞書の左上角のセルはいままで
・左上cell_組織辞書
と名付けていた。　組織辞書┏　と同義になるが、使っていないことから、この
名前は廃止した。

Range_組織辞書　は、　組織略称クリア　でも使われているため、
組織辞書┏　から　Range_組織辞書　を得る；
つまり、左上セル　を範囲として与えると、　不定列数連続業の範囲　返す関数
を定義しておくことが必要である。
Function Range_expand_ULA2VarColRows(Range_of_左上セルAs Range) As Range
を書いておこう。

また、名付けチェックについては、　Range_組織辞書　に代えて　組織辞書┏　を
設定しておく。

あわわ：

SingleHomeDict_namedRange
は、
MultiHomeDict_namedRange
の特殊例、であって、

SingleHomeDict_namedRange
は
SingleHomeDict
とは全く独立になっていたよ・・・

何ってこった。

SingleHomeDict
単体は、必要なのか？

SingleHomeDict
と
MultiHomeDict_namedRange
の特殊例である
SingleHomeDict_namedRange
は、きちんと一致するのか？

それは、一旦おいておいて、　MultiHomeDict_namedRange　から左上角(ULA)拡張
のコードを取ってこよう。
非常にシンプル；
   Dim R_n As Range
   Set R_n = ThisWorkbook.Names(strName).RefersToRange
   Set R_n = range_連続列最大行_range(R_n)
だったよ。　range_連続列最大行_range　が、まさにこれ。

Function range_連続列最大行_namedrange(strRangeName As String) as Range
   Dim R_n As Range
   Set R_n = ThisWorkbook.Names(strRangeName).RefersToRange
   ' Set R_n =...
   Set range_連続列最大行_namedrange = range_連続列最大行_range(R_n)
End Function
として、必要な箇所で以下のようにそのまま呼び出すか、
   Set ◆拡張範囲◆ = range_連続列最大行_namedrange(◆左上セルの名前◆）
必要なら以下で再呼び出しするのがいいかも。
Function Range_expand_ULA2VarColRows(左上セル As Range) As Range
   Range_expand_ULA2VarColRows = range_連続列最大行_namedrange(左上セル)
End Function
あるいは、
Function 左上セルから連続行拡張(左上セル As Range) As Range
   左上セルから連続行拡張 = range_連続列最大行_namedrange(左上セル)
End Function

.Clear したあと範囲を再度 Set するという間違いもあって、それも修正。

Range_組織辞書
は使われなくなった・・・と思ったのだけれど、範囲が変わったらその
新しい範囲でまた、Range_組織辞書　と名付けるなどという操作を、
▼１▼２▼３など随所ででやっている。

完全になくすまでまだちょっとかかりそう。

そのまえに、現在未定義で残っている名前を削除した。
削除した名前は次のとおり。

BU抽出
デバッグ
期間＿開始
期間＿終了
期間の審査数
区分抽出
仕向地抽出
包括抽出

これらは、半手作業であったときに使っていた名前で、現在すべて #REF! エラー
となっている。

以上、2021/02/11-1100_1424
